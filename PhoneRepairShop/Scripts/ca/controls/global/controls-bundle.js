define("controls/global/branch-selector/qp-branch-selector",["require","exports","tslib","aurelia-framework","aurelia-logging","apps/enhance/services/api-client","apps/enhance/services/mark-highlights","apps/enhance/services/control-helper"],function(e,t,i,n,a,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var l=a.getLogger("qp-branch-selector");var h={ArrowDown:1,ArrowUp:-1,Down:1,PageDown:7,PageUp:-7,Up:-1};var c=function(){function e(e,t){this.apiClient=e;this.taskQueue=t;this.loadingStatus="in-sync";this.highlightedIndex=undefined;this.treeOpen=false}t=e;e.prototype.configChanged=function(e,n){if(n===undefined){Object.assign(e,t.defaultConfig,i.__assign({},e))}};e.prototype.editModeChanged=function(e,t){if(e){if(!this.branches){this.loadBranches()}this.selectAllText()}};e.prototype.canSelect=function(e){switch(this.config.selectionMode){case undefined:case"all":return true;case"branches":return e.branch;case"organizations":return e.organization}return false};e.prototype.ignoreClicks=function(e){e.preventDefault();e.stopImmediatePropagation()};e.prototype.handleKey=function(e){var t=h[e.key];if(t!==undefined&&this.treeOpen!==e.altKey){e.preventDefault();e.stopImmediatePropagation();this.moveCursor(t)}switch(e.key){case"Enter":if(this.highlightedIndex!==undefined&&this.flatStructure[this.highlightedIndex]){this.select(this.flatStructure[this.highlightedIndex])}break;case"Esc":case"Escape":this.hide();e.preventDefault();e.stopImmediatePropagation();break;default:break}return true};e.prototype.onBlur=function(){var e=this;if(this.inputControl.value.trim()===""){this.value={id:"",text:""}}else{if(this.inputControl.value!==this.value.id){var t=this.flatStructure.find(function(t){return t.AcctCD.trim().toLowerCase()===e.inputControl.value.trim().toLowerCase()});if(t){this.value={id:t.AcctCD,text:t.AcctName}}else{this.value={id:this.inputControl.value,text:""}}}}this.hide();return true};e.prototype.hide=function(){this.treeOpen=false};e.prototype.highlight=function(e){if(this.canSelect(this.flatStructure[e])){this.highlightedIndex=e}};e.prototype.ignore=function(e){e.preventDefault();e.stopImmediatePropagation()};e.prototype.loadBranches=function(){return i.__awaiter(this,void 0,void 0,function(){var e=this;return i.__generator(this,function(t){if(!this.branchesPromise){this.loadingStatus="loading";this.branchesPromise=this.apiClient.getBranchData({dac:this.config.dac,screenId:o.getScreenID(),view:this.config.view}).then(function(t){e.branches=t.Data;e.loadingStatus="in-sync"})}return[2,this.branchesPromise]})})};e.prototype.moveCursor=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,a;return i.__generator(this,function(i){switch(i.label){case 0:if(!!this.treeOpen)return[3,3];this.treeOpen=true;if(!(!Array.isArray(this.flatStructure)||this.flatStructure.length===0))return[3,2];return[4,this.loadBranches()];case 1:i.sent();if(!Array.isArray(this.flatStructure)||this.flatStructure.length===0){return[2]}return[3,3];case 2:if(typeof this.highlightedIndex==="number"&&this.highlightedIndex>=0){return[2]}i.label=3;case 3:if(typeof this.highlightedIndex!=="number"||this.highlightedIndex<0){this.selectFirst()}else{t=this.highlightedIndex+e;n=e>0?1:-1;a=(e>0?this.flatStructure.length:0)+n;if(t<0){t=0}if(t>=this.flatStructure.length){t=this.flatStructure.length-1}for(;t!==a;t+=n){if(this.canSelect(this.flatStructure[t])){this.highlightedIndex=t;break}}}return[2]}})})};e.prototype.search=function(e){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:this.treeOpen=true;this.filter=e;if(!!this.branches)return[3,2];return[4,this.loadBranches()];case 1:t.sent();t.label=2;case 2:this.selectFirst(e);return[2]}})})};e.prototype.select=function(e,t){var i=this;if(this.canSelect(e)){this.value={id:e.AcctCD,text:e.AcctName};this.hide();this.taskQueue.queueTask(function(){i.selectAllText()})}return true};e.prototype.selectFirst=function(e){var t=this;this.highlightedIndex=undefined;if(e===undefined){if(this.value&&this.value.id){var i=this.flatStructure.findIndex(function(e){return e.AcctCD==t.value.id});this.highlightedIndex=i}}else{for(var n=0;n<this.flatStructure.length;n++){if(this.canSelect(this.flatStructure[n])){if(e===""||this.flatStructure[n].displaySegments.length>1){this.highlightedIndex=n;break}}}}};e.prototype.toggleSelector=function(e){e.preventDefault();e.stopImmediatePropagation();this.inputControl.focus();if(this.treeOpen){this.treeOpen=false;return}this.search()};e.prototype.conditionsChanged=function(){var e=this;if(!Array.isArray(this.branches)){return}var t=this.filter&&this.filter.toLocaleLowerCase()||"";var n=this.branches.slice().map(function(e){var n=i.__assign({},e),a=n.AcctCD,r=n.AcctName,s=n.BAccountID,o=n.ParentBAccountID;var l=t&&e.AcctName.toLocaleLowerCase().indexOf(t)>-1?e.Children:e.Children&&e.Children.filter(function(e){return!t||e.AcctCD.toLocaleLowerCase().indexOf(t)>-1||e.AcctName.toLocaleLowerCase().indexOf(t)>-1});return{AcctCD:a,AcctName:r,BAccountID:s,Children:l,ParentBAccountID:o}}).filter(function(e){return!t||e.Children&&e.Children.length||t&&(e.AcctName.toLocaleLowerCase().indexOf(t)>-1||e.AcctCD.toLocaleLowerCase().indexOf(t)>-1)});var a=[];for(var r=0,o=n;r<o.length;r++){var l=o[r];var h=i.__assign({},l),c=h.AcctCD,d=h.AcctName;var g={AcctCD:c,AcctName:d,branch:!l.Children||l.Children.length===0,displaySegments:s.markHighlights(t,c+" - "+d),organization:true,canSelect:false};g.canSelect=this.canSelect(g);a.push(g);if(Array.isArray(l.Children)){a.push.apply(a,l.Children.map(function(i){var n={AcctCD:i.AcctCD,AcctName:i.AcctName,branch:true,displaySegments:s.markHighlights(t,i.AcctCD+" - "+i.AcctName),organization:false,canSelect:false};n.canSelect=e.canSelect(n);return n}))}}this.flatStructure=a};e.prototype.selectAllText=function(){var e=this.inputControl.value.length;this.inputControl.setSelectionRange(0,e)};var t;e.defaultConfig={enabled:true};i.__decorate([n.bindable,i.__metadata("design:type",Object)],e.prototype,"config",void 0);i.__decorate([n.bindable,i.__metadata("design:type",Object)],e.prototype,"value",void 0);i.__decorate([n.observable({changeHandler:"conditionsChanged"}),i.__metadata("design:type",Object)],e.prototype,"branches",void 0);i.__decorate([n.observable({changeHandler:"conditionsChanged"}),i.__metadata("design:type",Object)],e.prototype,"filter",void 0);i.__decorate([n.observable,i.__metadata("design:type",Boolean)],e.prototype,"editMode",void 0);e=t=i.__decorate([n.customElement("qp-branch-selector"),n.autoinject,i.__metadata("design:paramtypes",[r.ApiClient,n.TaskQueue])],e);return e}();t.QpBranchSelectorCustomElement=c});define("text!controls/global/branch-selector/qp-branch-selector.css",[],function(){return".qp-branch-selector,\n.qp-branch-selector * {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\nqp-branch-selector {\n  display: block;\n}\n\n.branch-selector input {\n  color: transparent;\n}\n\n.branch-selector__display-text {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right:26px;  \n  height: 100%;\n  pointer-events: none;\n\n  margin: 0;\n  border: 0;\n  padding: 0 4px 0 6px;\n  line-height: 24px;\n\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.branch-selector__button {\n  margin: 2px 0 0;\n  background: #fff;\n  border: 0;\n  width: 20px;\n  color: rgba(0, 0, 0, .64);\n  cursor: pointer;\n}\n\n\n.edit-mode .branch-selector__display-text {\n  visibility: hidden;\n}\n\n.edit-mode input {\n  color: initial;\n}\n\n.branch-selector__branch-tree {\n  width: auto;\n  overflow-y: auto;\n  position: absolute;\n  z-index: 1000;\n  background: white;\n}\n\n.branch-selector__node {\n  display: block;\n  height: 18px;\n  padding: 4px 6px;\n  font-size: 13px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  \n}\n.branch-selector__node.can-select {\n  cursor: pointer;\n}\n\n.branch-selector__node-organization {\n  margin: 2px 0;\n}\n\n.branch-selector__node-branch {\n\n  padding-left: 30px;\n  position: relative;\n}\n\n.branch-selector__node-branch::before {\n\n  display: block;\n  position: absolute;\n  content: '';\n  width: 15px;\n  left: 10px;\n  /* left: 0;//2.35em; */\n  top: -50%;\n  height: 100%;\n  border-bottom: 1px dotted #bbb;\n  border-left: 1px dotted #bbb;\n}\n\n.branch-selector__node-organization+.branch-selector__node-branch::before {\n  height: 60%;\n  top: -15%;\n}\n"});define("text!controls/global/branch-selector/qp-branch-selector.html",[],function(){return'<template class="branch-selector ${editMode?\'edit-mode\':\'\'}" id="${config.id}"><require from="./qp-branch-selector.css"></require><require from="elements/qp-loader-indicator"></require><div class="editor ${config.class} ${editMode?\'focus\':\'\'}" style="display:flex;padding:0;position:relative" ref="rectControl"><input id="${config.id}_text" name="${config.name}" tabindex="${config.tabIndex}" value.to-view="value.id" ref="inputControl" blur.trigger="onBlur()" input.delegate="search(inputControl.value)" keydown.capture="handleKey($event)" style="margin:0;border:0;flex:1 0 auto;padding:0 4px 0 6px" autocomplete="new-password" focus.from-view="editMode"><div class="branch-selector__display-text" if.bind="value && value.id">${[value.id]}${value.text?\' - \'+value.text:\'\'}</div><button type="button" mousedown.trigger="toggleSelector($event)" class="sprite-icon branch-selector__button" tabindex="-1"><i class="control-icon control-ArrowDown"></i></button><qp-loader-indicator if.bind="treeOpen" style="position:absolute;bottom:0;left:0;right:0" loading-state.bind="loadingStatus"></qp-loader-indicator></div><div if.bind="treeOpen" class="branch-selector__branch-tree ${config.class}" mousedown.capture="ignoreClicks($event)" glue-to.bind="rectControl" style="max-height:210px;max-width:610px"><div if.bind="flatStructure"><div repeat.for="b of flatStructure" click.delegate="select(b,$event)" class="branch-selector__node ${b.organization?\'branch-selector__node-organization\':\'branch-selector__node-branch\'} ${highlightedIndex == $index?\'highlight\':\'\'} ${b.AcctCD == value ? \'selected\':\'\'} ${b.canSelect?\'can-select\':\'\'}" mouseenter.capture="highlight($index)"><template repeat.for="s of b.displaySegments"><mark if.bind="s.highlight">${s.text}</mark><template else>${s.text}</template></template></div></div></div></template>'});define("controls/global/calendar/qp-calendar",["require","exports","tslib","aurelia-framework","aurelia-logging","./services/calendar-service"],function(e,t,i,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var s=a.getLogger("qp-calendar");n.PLATFORM.global.px=n.PLATFORM.global.px||{setTitle:function(){return}};var o=4;var l=["January","February","March","April","May","June","July","August","September","October","November","December"];var h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var d=function(){function e(e,t,i,a){this.elem=e;this.animator=t;this.calendarService=i;this.tq=a;this.required=false;this.monthNames=l;this.shortMonthNames=h;this.shortDayNames=c;this.locale="en-US";var r=n.PLATFORM.global.top._dateFormatInfo;if(r){this.monthNames=r.monthNames.split(",");this.shortMonthNames=r.abbrMonthNames.split(",");this.shortDayNames=r.abbrDayNames.split(",")}var s=new Date;this.todayDate=new Date(s.getFullYear(),s.getMonth(),s.getDate());this.todayString=this.todayDateToString()}e.prototype.syncMonthYear=function(){if(this.value instanceof Date){this.month=this.value.getMonth();this.year=this.value.getFullYear();this.day=this.value.getDate()}else{this.month=this.todayDate.getMonth();this.year=this.todayDate.getFullYear();this.day=this.todayDate.getDate()}this.weeksToDisplay=this.selectedCalendarSheet=this.calendarService.getMonthSheet(this.year,this.month);this.setHighlight(this.year,this.month,this.day)};e.prototype.valueChanged=function(){this.syncMonthYear()};e.prototype.attached=function(){this.syncMonthYear();this.monthPaneEle&&this.monthPaneEle.focus()};e.prototype.configChanged=function(e,t){if(this.config){if(this.config.todayDate)this.todayDate=this.config.todayDate;if(this.config.todayString)this.todayString=this.config.todayString}this.syncMonthYear()};e.prototype.keyDown=function(e){var t=e.code||e.key;switch(t){case"Down":case"ArrowDown":this.moveHighlight(0,0,r.DAYS_IN_WEEK);break;case"Up":case"ArrowUp":this.moveHighlight(0,0,-r.DAYS_IN_WEEK);break;case"Right":case"ArrowRight":this.moveHighlight(0,0,1);break;case"Left":case"ArrowLeft":this.moveHighlight(0,0,-1);break;case"PageUp":this.moveHighlight(0,-1,0);break;case"PageDown":this.moveHighlight(0,1,0);break;case"Home":this.moveHighlight(-1,0,0);break;case"End":this.moveHighlight(1,0,0);break;case"Space":case"Spacebar":case" ":this.setHighlight(this.todayDate.getFullYear(),this.todayDate.getMonth(),this.todayDate.getDate());break;case"Enter":break;case"Esc":case"Escape":break;default:return true}e.stopPropagation()};e.prototype.wheel=function(e){if(e.deltaY>0){this.moveHighlight(0,1,0)}else{this.moveHighlight(0,-1,0)}};e.prototype.setHighlight=function(e,t,i){var n=e===this.year&&t===this.month;this.year=e;this.month=t;this.day=i;if(!n){this.selectedCalendarSheet=this.calendarService.getMonthSheet(e,t);this.handleDestinationChanged()}this.weeksToDisplay.forEach(function(n){n.days.forEach(function(n){if(n.day===i&&n.month===t&&n.year===e){n.highlighted=true}else if(n.highlighted){n.highlighted=false}})});this.selectedCalendarSheet.forEach(function(n){n.days.forEach(function(n){if(n.day===i&&n.month===t&&n.year===e){n.highlighted=true}else if(n.highlighted){n.highlighted=false}})})};e.prototype.hadnleAnimation=function(){var e=this;function t(e){return e<.5?2*e*e:-1+(4-2*e)*e}function i(e){return e*(2-e)}var n=performance.now();var a=n-this.animation.startTime;var r=!this.hadnleAnimation.pendingAnimation;if(a<this.animation.duration){var s=a/this.animation.duration;if(r){s=i(s)}var o=(this.animation.destination-this.animation.startPosition)*s;var l=this.animation.startPosition+o;this.animation.currentOffset=l;if(this.animation.destination<0?this.animation.destination<l:this.animation.destination>l){this.calendarSheet.style.transform="translateY("+l+"px)";requestAnimationFrame(function(){return e.hadnleAnimation()})}}else{this.calendarSheet.style.transform="";this.updateAnimation()}};e.prototype.updateAnimation=function(){if(this.animation.destination!==0){this.weeksToDisplay.splice(0,this.weeksToDisplay.length-6)}else{this.weeksToDisplay.splice(6)}this.tq.flushMicroTaskQueue();if(this.animation.pendingAnimation){this.calculateNextImmediateAnimation()}else{this.animation=undefined;this.animating=false}};e.prototype.calculateNextImmediateAnimation=function(){var e=this;var t,i;var n=this.selectedCalendarSheet.slice();var a=this.animation&&this.animation.pendingAnimation?300:450;var r=this.weeksToDisplay[1].days[6];var s=n[1].days[6];var o=this.calendarService.getCalendarSheetId(s.year,s.month);var l=this.calendarService.getCalendarSheetId(r.year,r.month);var h=o>l;var c=Math.abs(o-l)>1;var d=1;if(h){if(!c){while(n[0].days[1].day!==this.weeksToDisplay[this.weeksToDisplay.length-d].days[1].day){d++}n.splice(0,d)}(t=this.weeksToDisplay).splice.apply(t,[this.weeksToDisplay.length,0].concat(n))}else{if(!c){while(n[n.length-d].days[1].day!==this.weeksToDisplay[0].days[1].day){d++}n.splice(n.length-d)}(i=this.weeksToDisplay).splice.apply(i,[0,0].concat(n))}this.tq.flushMicroTaskQueue();var g=this.calendarSheet.getBoundingClientRect().height;var u=this.calendarSheet.scrollHeight;var p=u-g;this.animation={startTime:performance.now(),duration:a,startPosition:h?0:-p,destination:h?-p:0};requestAnimationFrame(function(){return e.hadnleAnimation()})};e.prototype.handleDestinationChanged=function(){if(!this.animating){this.animating=true;this.calculateNextImmediateAnimation()}else{if(this.animation&&!this.animation.pendingAnimation){this.animation.pendingAnimation=true;var e=performance.now();this.animation.startTime=e;this.animation.startPosition=this.animation.currentOffset;var t=Math.abs((this.animation.destination-this.animation.startPosition)/2);this.animation.duration=t}}};e.prototype.moveHighlight=function(e,t,i){var n=new Date(this.year+e,this.month+t,this.day+i);this.setHighlight(n.getFullYear(),n.getMonth(),n.getDate())};e.prototype.todayDateToString=function(){return Intl.DateTimeFormat(this.locale).format(this.todayDate)};i.__decorate([n.bindable,i.__metadata("design:type",Object)],e.prototype,"config",void 0);i.__decorate([n.bindable,i.__metadata("design:type",Object)],e.prototype,"value",void 0);e=i.__decorate([n.autoinject,n.customElement("qp-calendar"),i.__metadata("design:paramtypes",[Element,n.Animator,r.CalendarService,n.TaskQueue])],e);return e}();t.QpCalendarCustomElement=d});define("text!controls/global/calendar/qp-calendar.html",[],function(){return'<template><require from="./qp-calendar"></require><style>.calendar-table td,.calendar-table th{width:40px;box-sizing:border-box;text-align:right;font-weight:400}.calendar-table th{text-align:center}.calendar-table td:first-child,.calendar-table th:first-child{width:30px;text-align:right;padding:0 8px}</style><table class="calendar" cellpadding="0" cellspacing="0" style="z-index:11000"><tbody><tr><td class="calendarMT"><table cellpadding="0" cellspacing="0" border="0" style="height:100%;width:100%"><tbody><tr><td class="calendarNP" ref="prevMonthEle"><div class="sprite-icon control-icon" icon="PrevMonth" click.delegate="moveHighlight(0,-1,0)"><div class="control-icon-img control-PrevMonth"></div></div></td><td style="text-align:Center"><select value.bind="month"><option repeat.for="m of monthNames" model.bind="$index">${m}</option></select> <select value.bind="year"><option repeat.for="i of 11" model.bind="year+i-5">${year+i-5}</option></select></td><td class="calendarNP" ref="nextMonthEle"><div class="sprite-icon control-icon" icon="NextMonth" click.delegate="moveHighlight(0,1,0)"><div class="control-icon-img control-NextMonth"></div></div></td></tr></tbody></table></td></tr><tr><td><table cellspacing="0" align="Center" border="0" class="calendar-table" style="table-layout:fixed;border-collapse:collapse;overflow:hidden" keydown.trigger="keyDown($event)" wheel.trigger="wheel($event)" ref="monthPaneEle" tabindex="0"><colgroup><col><col repeat.for="i of 7" class="${(i+firstDayOfWeek+6)%7<=1?\'calendarWE\':\'\' & oneTime} "></colgroup><tbody style="display:block;max-height:186px" ref="calendarSheet"><tr repeat.for="week of weeksToDisplay"><td class="calendarWN calendarD">${week.weekNumber & oneTime}</td><td repeat.for="wday of week.days" class="calendarD ${wday.month !== month ? \'calendarOMD\' : \'\'} ${wday.weekend ? \'calendarWE\':\'\' & oneTime} ${wday.today ? \'calendarTD\' : \'\' & oneTime} ${wday.highlighted ? \'calendarSD\':\'\'} ">${wday.day & oneTime}</td></tr></tbody><thead><tr style="display:block;position:relative"><th class="calendarDH">#</th><th class="calendarDH" repeat.for="i of 7"> ${shortDayNames[(i+firstDayOfWeek)%7] & oneTime}</th></tr></thead></table></td></tr><tr><td class="calendarF" style="cursor:pointer" click.capture="selectTheDate(todayDate)"> ${todayString} </td></tr></tbody></table></template>'});define("controls/global/calendar/services/calendar-service",["require","exports","aurelia-pal"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DAYS_IN_WEEK=7;var n=864e5;var a=12;var r=6;var s=5;var o=function(){function e(){this.firstDayOfWeek=0;var e=i.PLATFORM.global.top.__PXCalendar;if(e){this.firstDayOfWeek=e.firstDayOfWeek}this.monthCache=new Map}e.prototype.getMonthSheet=function(e,t){var i=this.getWeeksFor(e,t);return i.slice()};e.prototype.getCalendarSheetId=function(e,t){return e*a+t};e.prototype.getWeekNumber=function(e){var i=new Date(e.getFullYear(),0,0);var a=e.getDay()+this.firstDayOfWeek;var r=Math.floor(((e.getTime()-i.getTime())/n-(a+t.DAYS_IN_WEEK)%t.DAYS_IN_WEEK+10)/t.DAYS_IN_WEEK);if(r===53&&e.getDate()>=28){return 1}return r};e.prototype.getWeeksFor=function(e,i){var n=new Date(e,i,1);var s=n.getDay();var o=n.getDay()===this.firstDayOfWeek;var l=o?t.DAYS_IN_WEEK:(t.DAYS_IN_WEEK+s-this.firstDayOfWeek)%t.DAYS_IN_WEEK;var h=new Date(e,i,1-l);var c=new Date(e,i+1,0).getDate();var d=h.getFullYear();var g=h.getMonth();var u=h.getDate();var p=this.getWeekNumber(h);var f=[];var m={weekNumber:p,days:[]};var v=0;for(;v<l;v++){m.days.push({year:d,month:g,day:u++,weekend:false,today:false})}g++;u=1;if(g===a){g=0;d++}for(;v<t.DAYS_IN_WEEK;v++){m.days.push({year:d,month:g,day:u++,weekend:false,today:false})}f.push(m);var b=Math.floor((c-(t.DAYS_IN_WEEK-l)%t.DAYS_IN_WEEK)/t.DAYS_IN_WEEK);for(var y=b;y>0;y--){p=p<52?++p:p=this.getWeekNumber(new Date(d,g,u));m={weekNumber:p,days:[]};for(var w=0;w<t.DAYS_IN_WEEK;w++){m.days.push({year:d,month:g,day:u++,weekend:false,today:false})}f.push(m)}p=p<52?++p:p=this.getWeekNumber(new Date(d,g,u));m={weekNumber:p,days:[]};for(v=0;u<=c;v++){m.days.push({year:d,month:g,day:u++,weekend:false,today:false})}g++;u=1;if(g===a){g=0;d++}for(;v<t.DAYS_IN_WEEK;v++){m.days.push({year:d,month:g,day:u++,weekend:false,today:false})}f.push(m);if(f.length<r){p=p<52?++p:p=this.getWeekNumber(new Date(d,g,u));m={weekNumber:p,days:[]};for(var w=0;w<t.DAYS_IN_WEEK;w++){m.days.push({year:d,month:g,day:u++,weekend:false,today:false})}f.push(m)}return f};return e}();t.CalendarService=o});define("controls/global/color-picker/qp-color-picker",["require","exports","tslib","aurelia-framework"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=true;var r=document.createElement("input");r.setAttribute("type","color");r.value="a";if(r.value==="a"){a=false}var s=function(){function e(){this.supportsColor=a}e.prototype.validateValue=function(e){var t=/^#[a-f\d]{6}$/i;var i=t.test(e.target.value);if(!i){e.target.value="#000000"}};i.__decorate([n.bindable,i.__metadata("design:type",Object)],e.prototype,"config",void 0);i.__decorate([n.bindable,i.__metadata("design:type",String)],e.prototype,"value",void 0);e=i.__decorate([n.customElement("qp-color-picker"),n.autoinject],e);return e}();t.QpColorPickerCustomElement=s});define("text!controls/global/color-picker/qp-color-picker.html",[],function(){return'<template style="display:inline-block"><div style="display:flex;padding:0;border:0" class.bind="config.class"><input if.bind="supportsColor" disabled.bind="config.readOnly" class="editor" style="flex:1 1 auto" type="color" tabindex="${config.tabIndex}" value.bind="value"> <span else css="background-color:${value};flex:1 1 auto;min-width:60px;"></span> <input class="editor size-xs" disabled.bind="config.readOnly" style="flex:0 1 auto" type="text" value.bind="value & updateTrigger:\'blur\'" id="${config.id}" tabindex="${config.tabIndex}" name="${config.name}" blur.capture="validateValue($event)"></div></template>'});define("controls/global/index",["require","exports","./branch-selector/qp-branch-selector","./color-picker/qp-color-picker","./suggester/qp-editor-wrapper"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});function r(e){e.globalResources([i.QpBranchSelectorCustomElement,n.QpColorPickerCustomElement,a.QpEditorWrapperCustomElement])}t.configure=r});define("controls/global/suggester/elements/qp-suggester",["require","exports","tslib","apps/enhance/services/localization","aurelia-event-aggregator","aurelia-framework","aurelia-logging","apps/enhance/services/suggestings-service"],function(e,t,i,n,a,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var l=s.getLogger("qp-suggester");var h=2;var c=386;var d=168;var g=32;var u=7;var p=24;var f=function(){function e(e,t,i,a){this.eventManager=e;this.suggestingServiceFabric=t;this.eventAggregator=i;this.taskQueue=a;this.debounceState={delay:250,timeoutId:undefined};this.eventSubscriptions=[];this.maxHeight=d;this.maxWidth=c;this.suggesting=false;this.serializedArgs="";this.localizedStrings=n.LOCALIZED_STRINGS}e.prototype.attached=function(){var e=this;this.eventSubscriptions.push(this.eventManager.addEventListener(this.editor,"input",function(t){return e.handleEditorInput(t)},r.delegationStrategy.capturing,true));this.eventSubscriptions.push(this.eventManager.addEventListener(this.editor,"keydown",function(t){return e.handleEditorKeyDown(t)},r.delegationStrategy.capturing,true));this.eventSubscriptions.push(this.eventManager.addEventListener(this.editor,"blur",function(t){return e.handleEditorBlur(t)},r.delegationStrategy.capturing,true));this.eventSubscriptions.push(this.eventManager.addEventListener(this.editor,"focus",function(t){return e.handleEditorFocus(t)},r.delegationStrategy.capturing,true));this.eventSubscriptions.push(this.eventManager.addEventListener(this.editor,"click",function(t){return e.handleEditorClick(t)},r.delegationStrategy.capturing,true));if(document.activeElement===this.editor){this.ensureSuggesterService();this.focused=true}var t=this.rectElement.getBoundingClientRect().width;this.minWidth=t};e.prototype.bind=function(){this.config.suggestAfter=this.config.suggestAfter||h;var e=[this.config.valueField&&this.config.valueField.toLowerCase(),this.config.descriptionName&&this.config.descriptionName.toLowerCase()].filter(function(e){return e!=null});this.fieldsToRequest=this.config.fields.filter(function(t){return e.includes(t.id.toLowerCase())})};e.prototype.changeHighLight=function(e){if(!this.preventHoverHighlight){this.highlightedSugestionIndex=e}};e.prototype.debounceHoverHighlight=function(){var e=this;this.preventHoverHighlight=true;clearTimeout(this.preventHoverHighlightTimeout);this.preventHoverHighlightTimeout=setTimeout(function(){e.preventHoverHighlight=false},g)};e.prototype.detached=function(){this.eventSubscriptions.forEach(function(e){return e.dispose()});this.eventSubscriptions=[];this.loading=undefined};e.prototype.ensureSuggesterService=function(){var e=this;var t=this.suggestingsService===undefined||this.config.inlineArgs;var i;if(this.config.dependsOn&&this.config.dependsOn.length){i=this.config.dependsOn.map(function(t){return{id:t.id,value:__px_all(e.editor)[t.controlID].value}});var n=JSON.stringify(i);if(this.serializedArgs!==n){t=true;this.serializedArgs=n}}if(t){this.suggestingsService=this.suggestingServiceFabric.getSuggestingService({args:i,descriptionName:this.config.descriptionName,fields:this.fieldsToRequest,graph:this.config.graph,inlineArgs:this.config.inlineArgs,pageSize:7,serverFiltering:this.config.serverFiltering,valueField:this.config.valueField,viewName:this.config.viewName})}};e.prototype.handleEditorBlur=function(e){this.focused=false;this.suggestingsService&&this.suggestingsService.abortRequest();this.hideSuggestions();return true};e.prototype.handleEditorClick=function(e){if(e.altKey&&!e.ctrlKey){e.preventDefault();e.stopImmediatePropagation();this.MoveHighligt(1)}return true};e.prototype.handleEditorFocus=function(e){this.ensureSuggesterService();this.focused=true;return true};e.prototype.handleEditorInput=function(e){var t=this;this.loading=true;var i=this.editor.value;if(i.length>=this.config.suggestAfter||this.suggesting){clearTimeout(this.debounceState.timeoutId);this.debounceState.timeoutId=setTimeout(function(){return t.suggestingsService.getSuggestions(i).then(function(e){t.suggestions=e;t.showSuggestions();t.loading=false}).catch(function(e){if(e.name==="AbortError"){l.info("suggestions request aborted by user input")}else{throw e}})},this.debounceState.delay)}};e.prototype.handleEditorKeyDown=function(e){switch(e.key){case"Esc":case"Escape":if(this.suggesting){this.hideSuggestions();e.preventDefault();e.stopImmediatePropagation()}break;case"Enter":if(this.suggesting){this.select(this.highlightedSugestionIndex)}return true;break;case"Up":case"ArrowUp":if(!!this.suggesting!==e.altKey){this.debounceHoverHighlight();e.preventDefault();e.stopImmediatePropagation();this.MoveHighligt(-1)}break;case"Down":case"ArrowDown":if(!!this.suggesting!==e.altKey){this.debounceHoverHighlight();e.preventDefault();e.stopImmediatePropagation();this.MoveHighligt(1)}break;case"PageDown":this.debounceHoverHighlight();e.preventDefault();e.stopImmediatePropagation();this.MoveHighligt(u);break;case"PageUp":this.debounceHoverHighlight();e.preventDefault();e.stopImmediatePropagation();this.MoveHighligt(-u);break;default:return true}};e.prototype.handleScroll=function(e){this.debounceHoverHighlight();var t=e.target;if(this.suggestions&&!this.suggestions.loading&&this.suggestions.haveMore&&this.suggestions.loadMore&&t.scrollTop+t.clientHeight+u*p>t.scrollHeight){this.suggestions.loadMore()}};e.prototype.hideSuggestions=function(){if(!this.suggesting){return}this.suggesting=false;this.suggestions=undefined};e.prototype.ignoreClicks=function(e){e.preventDefault();e.stopImmediatePropagation()};e.prototype.MoveHighligt=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n;var a=this;return i.__generator(this,function(i){switch(i.label){case 0:if(!!this.suggesting)return[3,3];if(!!this.suggestions)return[3,2];this.loading=true;return[4,this.suggestingsService.getSuggestions("").then(function(e){a.suggestions=e;a.loading=false}).catch(function(e){if(e.name==="AbortError"){l.info("suggestions request aborted by user input")}else{throw e}})];case 1:i.sent();i.label=2;case 2:this.showSuggestions();return[2];case 3:this.highlightedSugestionIndex+=e;if(this.highlightedSugestionIndex<0){this.highlightedSugestionIndex=0}if(this.highlightedSugestionIndex>this.suggestions.suggestionItems.length-1){this.highlightedSugestionIndex=this.suggestions.suggestionItems.length-1}if(Math.abs(e)>1){if(e>0){t="start";this.suggestionsContainer.scrollTop=this.suggestionsContainer.scrollTop+this.suggestionsContainer.clientHeight}else{this.suggestionsContainer.scrollTop=this.suggestionsContainer.scrollTop-this.suggestionsContainer.clientHeight;t="end"}}t="nearest";n=this.suggestionsContainer.querySelectorAll("qp-suggestion")[this.highlightedSugestionIndex];if(n){if("scrollBehavior"in document.documentElement.style){n.scrollIntoView({block:t})}else{n.scrollIntoView(e<0)}}return[2]}})})};e.prototype.select=function(e,t){if(t===void 0){t=undefined}var i=this.suggestions.suggestionItems[e];this.setEditorValue({display:i.display,useUpdateValue:!!t,value:i.value});if(t){t.preventDefault();t.stopImmediatePropagation()}this.hideSuggestions()};e.prototype.showSuggestions=function(){var e=this;this.highlightedSugestionIndex=0;if(this.suggesting||!this.focused){return}this.suggesterWidth=undefined;this.suggesting=true;this.taskQueue.queueTask(function(){if(e.suggestionsContainer){var t=e.suggestionsContainer.getBoundingClientRect().width;e.suggesterWidth=t}})};i.__decorate([r.bindable,i.__metadata("design:type",Object)],e.prototype,"config",void 0);i.__decorate([r.bindable,i.__metadata("design:type",HTMLElement)],e.prototype,"editor",void 0);i.__decorate([r.bindable,i.__metadata("design:type",HTMLElement)],e.prototype,"rectElement",void 0);i.__decorate([r.bindable,i.__metadata("design:type",Function)],e.prototype,"setEditorValue",void 0);e=i.__decorate([r.autoinject,i.__metadata("design:paramtypes",[r.EventManager,o.SuggestingsServiceFabric,a.EventAggregator,r.TaskQueue])],e);return e}();t.QpSuggesterCustomElement=f});define("text!controls/global/suggester/elements/qp-suggester.css",[],function(){return"/* qp-editor-wrapper,\nqp-editor-wrapper * {\n  box-sizing: border-box;\n\n} */\n\nqp-suggester {\n  display: block;\n  position: absolute;\n  /* z-index: 1000; */\n  top: 100%;\n  /* overflow: hidden; */\n\n\n}\n\n.qp-suggester,\n.qp-suggester * {\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n\n\n}\n\n.qp-suggester.loading{\n  -webkit-filter:grayscale(.5);\n          filter:grayscale(.5);\n}\n.qp-suggester.show-above {\n  -webkit-transform:translateY(-100%);\n          transform:translateY(-100%);\n  -webkit-transform:translateY(calc(-100% - 1px));\n          transform:translateY(calc(-100% - 1px));\n}\n\n.qp-suggester.show-left {\n  -webkit-transform:translateX(-100%);\n          transform:translateX(-100%);  \n}\n\n.qp-suggester.show-left.show-above {\n  -webkit-transform:translate(-100%,-100%);\n          transform:translate(-100%,-100%);  \n}\n\nqp-suggestion {\n  display: block;\n  height:24px;\n  padding: 4px 6px;\n  font-size: 13px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  cursor: pointer;\n}\n\n.loading-placeholder.loading {\n  position: relative;\n}\n.loading-placeholder.loading:before{\n  position: absolute;\n  top:2px;\n  left: 5px;\n  right:5px;\n  bottom: 2px;\n  content:'';\n  background-color: #ccc;\n}\n"});define("text!controls/global/suggester/elements/qp-suggester.html",[],function(){return'<template><require from="./qp-suggester.css"></require><div if.bind="suggesting && suggestions" ref="suggestionsContainer" glue-to.bind="rectElement" class="qp-suggester ${loading || suggestions.loading ?\'loading\':\'\'}" css="max-height:${maxHeight}px;overflow-y:auto; ${suggesterWidth?\'width:\'+suggesterWidth+\'px;\':\'\' }min-width:${minWidth}px; \n  background-color:white; max-width:${maxWidth}px;" scroll.trigger="handleScroll($event)" mousedown.capture="ignoreClicks($event)"><qp-suggestion repeat.for="i of suggestions.suggestionItems" class="${$index==highlightedSugestionIndex?\'suggestion-highlight\':\'\'}" mouseenter.capture="changeHighLight($index)" click.delegate="select($index,$event)"><template repeat.for="s of i.segments"><mark if.bind="s.highlight">${s.text}</mark><template else>${s.text}</template></template></qp-suggestion><qp-suggestion if.bind="suggestions.haveMore" repeat.for="i of 1" class="loading-placeholder ${suggestions.loading}">loading</qp-suggestion><div if.bind="suggestions.totalCount==0" style="padding:5px .5em;color:#888;font-size:13px;white-space:nowrap;text-overflow:ellipsis" class="no-results-found"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" style="vertical-align:bottom;margin-right:.5em" fill="currentColor"><g id="sad" stroke="none" stroke-width=".8" fill="none" fill-rule="evenodd"><g id="Group" fill="#c8930c"><circle cx="10.84" cy="5.68" r="1.03"></circle><circle cx="5.16" cy="5.68" r="1.03"></circle><path d="M8,0 C3.58177778,0 0,3.58177778 0,8 C0,12.4182222 3.58177778,16 8,16 C12.4182222,16 16,12.4182222 16,8 C16,3.58177778 12.4182222,0 8,0 Z M8,14.6671111 C4.31822222,14.6671111 1.33333333,11.6822222 1.33333333,8.00044444 C1.33333333,4.31844444 4.31822222,1.33333333 8,1.33333333 C11.6822222,1.33333333 14.6671111,4.31822222 14.6671111,8.00022222 C14.6671111,11.6822222 11.6822222,14.6671111 8,14.6671111 Z" fill-rule="nonzero"></path><path d="M11.1988131,12.3870968 C10.9618705,12.3870968 10.7318091,12.2666654 10.6093237,12.0538815 C10.0854351,11.1424204 9.08513805,10.5760202 7.99974353,10.5760202 C6.91411964,10.5760202 5.914052,11.1424204 5.39016335,12.0538815 C5.21125217,12.3649409 4.80250892,12.4785719 4.47748694,12.307248 C4.15223558,12.1363627 4.03342021,11.7454545 4.21233139,11.434395 C4.97247455,10.1118441 6.42394887,9.29032258 7.99997291,9.29032258 C9.57576756,9.29032258 11.0274713,10.1120635 11.7876144,11.434395 C11.9665256,11.7454545 11.8479396,12.1361433 11.5226882,12.307248 C11.4194703,12.3614311 11.3084536,12.3870968 11.1988131,12.3870968 Z"></path></g></g></svg> ${localizedStrings.noResultsFound} </div></div></template>'});define("controls/global/suggester/qp-editor-wrapper",["require","exports","tslib","aurelia-framework","aurelia-logging"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=a.getLogger("qp-editor-wrapper");var s=function(){function e(e,t){this.element=e;this.tq=t}e.prototype.attached=function(){this.editor=this.element.querySelector(".editor");if(this.editor){this.editor.setAttribute("autocomplete","new-password")}this.selector=this.element.querySelector(".selector");this.rectElement=this.selector||this.editor;if(!this.selector){r.warn("no selector",this.element)}else{if(!this.selector.object){r.error("no object",this.selector)}else{this.selector.object.autoComplete=0}}};e.prototype.setEditorValue=function(e,t,i){if(this.selector&&this.selector.object){var n=this.selector.object;if(this.editor.value.trim()===""){n.setValue("","")}var a=n.hasHint?e+" - "+t:t;if(i){n.updateValue(e,a)}else{if(n.textField&&n.textMode===2){this.editor.value=t||e}else{this.editor.value=e}this.tq.queueTask(function(){return n.setHintText(a,true)})}}else{r.warn("no px object")}};i.__decorate([n.bindable({defaultBindingMode:n.bindingMode.oneTime}),i.__metadata("design:type",Object)],e.prototype,"config",void 0);e=i.__decorate([n.autoinject,n.customElement("qp-editor-wrapper"),i.__metadata("design:paramtypes",[Element,n.TaskQueue])],e);return e}();t.QpEditorWrapperCustomElement=s});define("text!controls/global/suggester/qp-editor-wrapper.html",[],function(){return'<template><require from="./elements/qp-suggester"></require><slot></slot><qp-suggester if.bind="config.suggester && editor" editor.two-way="editor" rect-element.bind="rectElement" set-editor-value.call="setEditorValue(value,display,useUpdateValue)" config.bind="config.suggester"></qp-suggester></template>'});